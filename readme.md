# README

## ライセンス

本ツールは**非商用目的で利用可能**です。商用利用を希望される場合は、事前に作者に連絡し、許可を得る必要があります。詳細は [LICENSE](./LICENSE) をご確認ください。

---

## 検索拡張ツール使用方法

### インストール手順

1. **`fileCp.ps1` を実行**  
   - 検索拡張ツールがエクセルアドインの格納場所にコピーされます。  
   - 格納場所: `C:\Users\<ユーザ名>\AppData\Roaming\Microsoft\AddIns`  
   - 処理終了後、格納場所のショートカットリンクが作成されます。  
   - **失敗時:** 「`copy_ng`」ファイルが作成されます。

2. **エクセルを起動**

3. **アドインを登録**  
   - 「開発」タブ → 「EXCEL アドイン」を押下  
   - アドインのポップアップで「参照」を押下し、`SearchExtensionAddin.xlam` を選択 → 「OK」  
   - アドイン画面で「Searchextensionaddin」にチェックを入れ、「OK」を押下。

4. **確認**  
   - エクセル画面に「エクセル検索拡張ツール」タブが表示されていることを確認。  

これでインストール完了です。

---

### 使用方法

1. **エクセル検索拡張ツールタブからメニューを選択**  

#### ブック内文字列検索・置換  
- 検索・置換機能を利用できます。通常の検索画面と同様の使用感です。  
- **検索範囲:** 「すべて」「セル」「図形」から選択可能（デフォルト: 「すべて」）。  
- **正規表現:** キャプチャ置換が可能です（正規表現にチェックを入れた場合）。

#### ファイル検索  
- 検索場所や対象ファイルを指定して検索が可能です。  
  - 検索場所は「…」ボタンからフォルダを選択、または直接入力（最後に「\」は不要）。  
  - 対象ファイルは「;」区切りで複数指定可能（例: `*.xlsx` は使用不可）。  
- **検索結果:** 「【ファイル検索】検索結果」シートに出力されます。  
- **置換結果:** 「【ファイル検索】置換結果」シートに出力されます。  
- 検索・置換の仕様は「ブック内検索・置換」と同様です。

---

### 注意事項

- **正規表現の適用範囲:** 検索・置換文字列のみに適用され、ファイル検索の「検索場所」や「対象ファイル」には適用されません。  
- **置換実行時の注意:** エクセルの仕様上、置換後に「Ctrl + Z」で戻すことができません。**バックアップを事前に取得してください。**  
- **ファイル検索の仕様:**  
  - ファイル名が「~$」で始まるファイル（エクセル一時ファイル）は検索対象外です。  
  - 正規表現を使用する際は、エスケープ文字（例: `\`）に注意してください。  

---

### アドインの無効化

1. **エクセルを起動**  
2. 「開発」タブ → 「EXCEL アドイン」を押下  
3. アドイン画面で「Searchextensionaddin」のチェックを外し、「OK」を押下。  
4. 「エクセル検索拡張ツール」タブが削除されることを確認。  

---

### アンインストール

1. 「アドインの無効化」を実施。  
2. 作成されたショートカットリンクからアドイン格納先に遷移し、`SearchExtensionAddin.xlam` を削除。  
3. 「開発」タブ → 「EXCEL アドイン」を押下。  
4. 確認メッセージ（「アドイン '<ファイルパス>' が見つかりません。リストから削除しますか？」）で「はい」を押下。  
5. アドインリストから「Searchextensionaddin」が削除されていることを確認。  

---

### アップデート予定機能

- **現在の予定:** 特になし。  

---

## 最後に

バグや追加機能のアイデアはいつでも受け付けています。ただし、対応や機能アップデートの時期は未定です。  
