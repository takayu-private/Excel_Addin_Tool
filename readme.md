# README

## ライセンス

本ツールは**非商用目的で利用可能**です。商用利用を希望される場合は、事前に作者に連絡し、許可を得る必要があります。詳細は [LICENSE](./LICENSE) をご確認ください。

---

## エクセル拡張ツール使用方法

### インストール手順

1. **`fileCp.ps1` を実行**  
   - 検索拡張ツールがエクセルアドインの格納場所にコピーされます。  
   - 格納場所: `C:\Users\<ユーザ名>\AppData\Roaming\Microsoft\AddIns`  
   - 処理終了後、格納場所のショートカットリンクが作成されます。  
   - **失敗時:** 「`copy_ng`」ファイルが作成されます。

2. **エクセルを起動**

3. **アドインを登録**  
   - 「開発」タブ → 「EXCEL アドイン」を押下  
   - アドインのポップアップで「参照」を押下し、対象のアドインファイルを選択 → 「OK」
      - `SearchExtensionAddin.xlam`
      - `FunctionExtensionAddin.xlam`
   - アドイン画面に戻り対象のアドインにチェックを入れ、「OK」を押下。
      - 「Searchextensionaddin」
      - 「Functionextensionaddin」

4. **確認**  
   - エクセル画面に「エクセル検索拡張ツール」タブが表示されていることを確認。  

これでインストール完了です。

---

## 使用方法

### 1. エクセル検索拡張ツール

「エクセル検索拡張ツール」タブから、以下の機能を選択してご利用ください。

#### 1.1 ブック内文字列検索・置換

Excelブック内の文字列を検索・置換できます。  
標準の検索ダイアログに近い操作感で使用可能です。

- **検索対象範囲**  
  「すべて」「セル」「図形」から選択可能（デフォルトは「すべて」）

- **正規表現対応**  
  「正規表現」にチェックを入れることで、キャプチャ置換などの高度な検索・置換が可能です。

#### 1.2 ファイル検索

指定フォルダ内の複数ファイルに対して、検索・置換が行えます。

- **検索場所の指定**  
  「…」ボタンでフォルダ選択、またはパスを直接入力（末尾の `\` は不要）

- **対象ファイルの指定**  
  `;`（セミコロン）区切りで複数のファイル名を指定可能  
  ※ ワイルドカード（例: `*.xlsx`）は使用できません

- **検索・置換結果の出力**  
  - 検索結果は「【ファイル検索】検索結果」シートに出力  
  - 置換結果は「【ファイル検索】置換結果」シートに出力

- **動作仕様**  
  - 検索、置換は「ブック内文字列検索・置換」と同様の仕様で動作します。
  - ファイル検索中にエラーが発生した場合は対象ファイルパス(絶対パス)をログに出力し、次のファイルを検索します。
    エラーログのパス
    `C:\Users\YuukiTakahashi\Documents\ExcelTmpErrFileList.txt`

#### 1.3 注意事項

- **正規表現の適用範囲:**  
  正規表現は検索・置換文字列にのみ適用されます。ファイル検索の「検索場所」や「対象ファイル」には適用されません。

- **置換実行時の注意:**  
  Excelの仕様により、置換操作後に「Ctrl + Z」で元に戻すことができません。  
  👉 **事前にバックアップを取得してください。**

- **ファイル検索の仕様:**  
  - 一時ファイル（ファイル名が `~$` で始まるもの）は検索対象外です。  
  - 正規表現を使用する際は、エスケープ文字（例: `\`）の入力にご注意ください。

---

### 2. 関数拡張ツール

Excelのセルに、通常通り関数を入力してご利用ください。  
特別な操作は不要で、普段通りの関数入力で使用できます。

---

### アドインの無効化

1. **エクセルを起動**  
2. 「開発」タブ → 「EXCEL アドイン」を押下  
3. アドイン画面で「Searchextensionaddin」のチェックを外し、「OK」を押下。  
4. 「エクセル検索拡張ツール」タブが削除されることを確認。  

---

### アンインストール

1. 「アドインの無効化」を実施。  
2. 作成されたショートカットリンクからアドイン格納先に遷移し、`SearchExtensionAddin.xlam` を削除。  
3. 「開発」タブ → 「EXCEL アドイン」を押下。  
4. 確認メッセージ（「アドイン '<ファイルパス>' が見つかりません。リストから削除しますか？」）で「はい」を押下。  
5. アドインリストから「Searchextensionaddin」が削除されていることを確認。  

---

### アップデート予定機能

- **現在の予定:** 特になし。  

---

## 最後に

バグや追加機能のアイデアはいつでも受け付けています。ただし、対応や機能アップデートの時期は未定です。  
